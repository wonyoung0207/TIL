# 애니메이션 재생

---

>

## 재생에 필요한 요소

1. `AnimationMixer`
2. `AnimationClip`
3. `AnimationAction`
4. `Clock + deltaTime`
5. (루프 안에서 `mixer.update`)

## 1. **AnimationMixer**

- `THREE.AnimationMixer` : 애니메이션을 재생/제어하는 핵심 컨트롤러
- 보통 `gltf.scene`(모델 전체) 또는 특정 객체를 타겟으로 생성

```js
const mixer = new THREE.AnimationMixer(gltf.scene)
```

## 2. **AnimationClip**

- glTF 모델 안에 포함된 애니메이션 데이터 (`gltf.animations`)
- 하나의 파일에 여러 개의 클립이 들어올 수 있음

```js
console.log(gltf.animations) // AnimationClip[]
```

## 3. **AnimationAction**

- `AnimationMixer.clipAction(clip)` 을 통해 생성되는 개별 실행 단위
- 재생, 정지, 루프, 페이드 인/아웃 등 제어 가능

```js
const action = mixer.clipAction(gltf.animations[0])
action.play()
```

## 4. **Clock / DeltaTime**

- 애니메이션을 시간에 맞게 업데이트하기 위해 `deltaTime` 필요
- 일반적으로 `THREE.Clock` 를 사용

```js
const clock = new THREE.Clock()
function animate() {
  const delta = clock.getDelta()
  mixer.update(delta)
  renderer.render(scene, camera)
  requestAnimationFrame(animate)
}
```

## 5. **Renderer Loop**

- `mixer.update(delta)` 는 반드시 **렌더 루프 내에서 호출**해야 애니메이션이 진행됨
- 한 번만 실행하면 정지된 상태로 끝남

## 6. **모델 스켈레톤 / MorphTarget (선택적)**

- glTF 애니메이션은 크게 두 가지 방식이 있음:
  1. **스켈레탈 애니메이션**: 본(bone) 계층구조와 스키닝(skinning) 기반 → 캐릭터 움직임
  2. **Morph Target 애니메이션**: 버텍스 형태 변형 → 얼굴 표정, 근육 변화 등
- 둘 다 glTF 안에 포함되어 `AnimationClip`으로 제어됨.
   특별한 추가 설정은 필요 없고, `AnimationMixer`가 알아서 처리.

## 전체 흐름 정리

1. `GLTFLoader` → `gltf.scene` + `gltf.animations` 가져오기
2. `AnimationMixer` 생성 (타겟: `gltf.scene`)
3. `AnimationClip` 선택 (`gltf.animations[n]`)
4. `mixer.clipAction(clip)` 으로 `AnimationAction` 만들고 `play()`
5. `THREE.Clock` 으로 deltaTime 구해서 루프에서 `mixer.update(delta)` 호출