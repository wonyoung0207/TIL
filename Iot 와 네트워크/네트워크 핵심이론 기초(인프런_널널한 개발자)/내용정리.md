# 내용정리

---

>

## 컴퓨터 구조

#### S/W : Logical

1. App
   1. User Mode
      1. L5 의 윗부분을 나타냄
      2. Socket 또한 여기 속하며, Socket은 File로써 Process 에 의해 열리고 닫힌다. 
2. System(OS)
   1. Kernel Mode 

#### H/W : Physical

1. NIC 같은 물리적 장치 등등...

## OSI 7Layer 

#### Layered 

1. 층층이 쌓여있는 것으로, 상호간 의존관계로 되어있는 것을 뜻한다. 
2. 즉, 위에가 있으려면 무조건 밑에가 있어야함을 의미한다. ( 의존 관계!! )

#### 식별자

1. L2
   1. **Mac 주소** : NIC 식별자 
   2. 물리적 주소
   3. 48bit 주소체계 사용
2. L3 
   1. **IP 주소** : HOST 의 식별자 
   2. 인터넷 주소 
   3. 32bit 주소체계 사용 
3. L4
   1. Port번호 : 서비스, 프로세스 식별자 

<img src="./images/OSI7Layer.jpg" width="600">

#### 1.  물리 계층

1. HW
   1. NIC 같은 완전한 HW가 여기에 속한다. 
2. NIC 
   1. 네트워크 인터페이스 카드 (LAN 카드)
   2. NIC를 식별하기위한 것이 **MAC 주소** 이다. 

#### 2. 데이터링크 계층

1. HW와 SW의 중간
   1. Driver 가 여기에 속함 
2. Ethernet
   1. 유선 인터넷 

#### 3. 네트워크 계층

1. Internet 
2. IP

#### 4. 전송 계층

1. TCP
2. UDP

#### 5. 세션 계층

1. TLS ( SSL )

#### 6. 표현 계층

#### 7. 응용 계층

1. HTTP 



## Host 

<img src="./images/Host개념.jpg" width="500">

#### 개념

1. Computer + Network 
2. 컴퓨터에 인터넷이 연결되어있으면 Host라고 한다. 

#### 구성

1. Switch
   1. 네트워크 그 자체를 이루는 host
   2. IP 가진 모든 컴퓨터 
   3. End-Point가 Switch 의 한 부분이다.
2. End-Point
   1. 단말기 ( End-Point + Computer )
   2. 네트워크 이용 주체 
   3. 즉, 인터넷을 통해 이용되는 주체 ( Server, Client, Peer 등등.. )



## Switch 

#### 개념

1. 현실의 **교차로**라고 생각하면 된다. 
2. 차량(Packet)이 출발지를 떠나 목적지로 향할때, 여러 교차로를 지나게 된다. 교차로마다 가야할 방향을 정해야 하는데, 이때 사용되는 개념이 Switch 와 Switching이다. 
3. 따라서 각 Layer 마다 Switch 라는 의미가 존재하며 해당 Switch의 역할은 `Interface 선택` 이다. 
4. 이때 Switch는 각 계층마다 `Interface`가 의미하는게 다르다. 
   1. L3 Switch는 Router 의 역할로, 경로 선택을 의미하며 
   2. L2 Switch는 Mac주소 선택의 의미를 가진다. 



## NIC ( Network Interface Card )

#### 개념

1. LAN 카드 라고도 한다. 
   1. 하지만 NIC(닉) 이라고 많이 말함 
2. NIC은 H/W 로, MAC 주소를 가진다. 

#### 네트워크 규모

<img src="./images/네트워크 규모.jpg" width="400">

1. LAN은 "**네트워크 규모**" 중 하나이다. 
2. 규모중 가장 작은 범위가 LAN이다. 
3. LAN
   1. OSI 의 L1, L2 인 H/W
4. WAN
   1. OSI 의 L3 이상인 S/W

#### NIC 표기법

<img src="./images/NiC표기.jpg" width="400">

1. PC에 **검은점과 선**으로 표시한다. 



## L2 Access Switch 

<img src="./images/허브 스위치.jpg" width="800">

#### 개념

1. End-Point 와 직접 연결되는 스위치이다. **(Network Access계층**에서 사용)
2. L2 스위치는 MAC 주소를 가지고 스위칭 한다. 

#### 연결 확인

1. 주황 LED
   1. 연결에 이상있음
   2. **LINK-DOWN** 이라고함 
2. 녹색 LED
   1. 연결 정상 
   2. **LIND-UP** 이라고함 

#### L2 Distribution Switch 

<img src="./images/스위치 동작구조.jpg" width="600">

1. L2 Switch를 위한 "고성능 스위치" 를 뜻한다. 
2. 대부분 VLAN 기능을 제공한다. 



## Broadcast 

#### 개념

1. "방송"의 뜻을 가지며 로컬랜 상에 붙어있는 모든 네트워크 장비들에게 보내는 통신
   1. 즉, "1 : 전체"  라고 생각하면 된다. 
2. 따라서 브로드캐스트를 남발하면 범위안의 네트워크가 엄청 느려져 재기능을 하지 못한다. 
   1. 브로드캐스트 도매인 범위 설정으로 해결가능 



## 가상 머신

#### 개념

1. Virtual Machine 으로, H/W를 S/W 로 구현한것
   1. CPU = Machine 이라 부르고, Vertual 은 Logical 한 S/W를 뜻함
   2. 따라서 S/W를 이용해 CPU를 구현한 것이다. 



## IPv4

#### IP

1. Host를 식별하는 네트워크 주소이다. 
2. Network ID와 Host ID로 나뉜다. 

#### 구조

<img src="./images/IPv4.jpg" width="600">

1. Network ID
   1. 배송시 사용되는 주소지로 예를들면, 시, 구, 동 같은 큰 범위를 나타내는 "물류센터" 이다. 
2. Host ID 
   1. 개별집을 구분하는 "개인컴퓨터" 이다. 



## Packet 

#### 개념

1. L3 = IP = Packet 
2. 하나의 조각을 뜻하며, 기본 크기는 1500Bytes (1.4KB) 이다. 
3. 즉, 데이터 덩어리가 분할된 Segment 하나가 포장된 형태를 **Packet** 이라고 부른다. 

#### 구조

<img src="./images/packet.jpg" width="600">

1. Header 
   1. 출발지(Src), 목적지(Dst)
2. Payload
   1. 데이터 



## 캡슐화 ( Encapsulation )

#### 개념

1. 내용물을 포장(캡슐화) 하는것을 뜻한다. 
   1. 내용물을 푸는것은 "Decapsulation" 이다. 
2. 즉, 하나의 데이터 덩어리(Header + Payload)를 포장하는 것이 캡슐화이다. 
3. 주로 Encapsulation은 송신측에서 일어나고, 수신측에서는 Decapsulation 이 일어난다. 
   1. 송신 : 데이터를 분할 후 포장
   2. 수신 : 포장된 데이터를 분해 


#### 구조

<img src="./images/packet 캡슐화.jpg" width="600">



## TCP/IP 송수신

<img src="./images/TCP_IP송수신 구조.jpg" width="1000">

##### 1. copy

1. 서버의 DB로부터 **원본 파일을 복제**한다. 
2. Program의 Buffer에 복제 파일을 넣는다. 

##### 2. send / Recive

1. 운영체제의 입출력을 하기 위해 **`Socket I/O의 Buffer`에 적제**한다. 

##### 3. 분해

1. `Buffer`에 **적제된 내용**을 잘게 **분해**한다. 
2. 이때 데이터 덩어리가 `Segment` 라는 조각으로 분해된다. 

##### 4. 포장

1. 분해된 **`Segment` 조각**을 네트워크 전송을 위해 **포장** 한다. 
2. 이때 포장된 **Segment 조각 하나를 Packet** 이라고 한다. 

##### 5. 운송

1. **하나의 `Packet`을 네트워크를 통해 `Frame`화 시켜 전송**한다. 
2. `Frame`은 유통과정(네트워크)에서 수시로 택배차를 갈아탄다. 
3. 이때 `Packet`은 순서대로 보내지며, 일정량을 보내고 나면 ACK 을 받을때까지 `wait` 상태로 대기한다. 
   1. 만약 수신측의 `여유공간(Window Size)` 이 없는경우에도 `wait` 상태로 전환되어 더이상 데이터를 전송하지 않는다. 


##### 6. 배송

1. 전송된 `Frame`을 받아 `Packet`의 형태로 전달받는다. 

##### 7. 포장해제 

1. 포장된 `packet` 안에있던 `segment` 를 꺼낸다. 
2. 여기서 Network 가 잘 받았다는 **ACK 신호를 송신측에 전송**한다. 
   1. **`ACK + 여유공간`** 에 대한 정보를 전송한다.
   2. 예를들어, `ACK #3` 의 신호를 송신측으로 보내면 송신측은 `ACK #2` 까지의 데이터가 잘 갔다고 판단하고 3번 데이터부터 전송하는데, 이때 같이온 `여유공간` 정보를 토대로 `wait` 할것인지 `send` 할 것인지를 결정하게 된다. 
3. **Network 장애**
   1. 여기서 Network 에 대한 장애가 발생할 수 있다. 
   2. Loss ( 유실 )
      1. Frame 전송시 데이터가 유실되는 경우 발생
      2. 무조건 Network 상의 문제이다. 
   3. Re-Transmission
      1. Ack 이 안오는 경우 발생
      2. Packet을 재전송 하게되는데, 이때도 `Ack-Duplication` 에러가 추가적으로 발생할 수 있다. 
      3. 무조건 Network 의 문제이다. 
   4. Out Of Order
      1. 패킷의 전송 순서가 잘못된 경우 발생 
      2. Network 문제 
      3. 예를들어, `3번이 안오고 4번이 도착한 경우` OR `4번이 오고 3번이 뒤늦게 온 경우` 
   5. Zero Window 
      1. Network 가 `Process 의 Buffer`를 비워내는 속도보다 빨라서 `I/O Buffer` 에 Full 이 일어난 경우
      2. End-Point 의 App(Program) 문제

##### 8. 채움

1. 전송받은 `Segment` 를 Socket I/O 에 순차적으로 적제한다. 
2. I/O Buffer에는 계속 "**채움**" 이 일어나게 되는데, Network 성능에 따라 속도차가 생기게 되므로 항상 **여유공간** 을 계산하게 된다. 
3. **여유공간(Window Size)** 은 `I/O Buffer` 에서 관리되며, 일정량의 `Segment`가 조립되면 `Process Buffer` 로 올리게 된다. 
4. I/O Buf 에 쌓는것은 운영체제의 TCP 가 쌓아준다. 

##### 9. Read / Recive

1. `Program의 Buffer` 에 데이터를 적제한다. 
2. 해당 `Buffer`는 개발자가 용량을 정할 수 있다. 

##### 10. 비움 

1. `Process Buf` 에서는 계속해서 **비움** 이 일어난다
   1. "**비움**" 은 Program에 데이터를 사용하는 것을 뜻함