# Stateful 과 Stateless 개념정리

---

>[참고 사이트1](https://inpa.tistory.com/entry/WEB-%F0%9F%93%9A-Stateful-Stateless-%EC%A0%95%EB%A6%AC)

## Stateful ( 상태유지 )

### 정의

- 클라이언트와 서버 관계에서 **서버가 클라이언트의 상태를 보존**함을 의미

### 동작 방식 

- 클라이언트의 정보를 기억한다라는 말은 어딘가에 정보를 저장하고 통신할때마다 읽는다는 뜻
  - 일반적으로 브라우저의 **쿠키(Cookie)**에 저장되거나, 서버의 **세션(Session)** 메모리에 저장되어 상태를 유지
- 예를들어 **홈페이지의 로그인**이 있다. 
  - 로그인하면 페이지 이동해도 로그인이 풀리지 않고 유지되는 것이 바로 서버가 클라이언트의 상태를 유지(기억) 하고 있으니 가능한 것 

### Stateful 한 프로토콜 

- 대표적인 Stateful 구조를 따르는 프로토콜이 바로 TCP의 3-handshaking 과정이다. 
  1. 클라이언트가 서버에 접속 요청 보냄
  2. 서버는 요청을 받고 클라이언트에 요청을 수락하는 Ack 전송
  3. 클라이언트는 서버에게 수락 확인으로 Ack 또 보낸다. 
  4. 세션으로 연결되며 서버와 클라이언트는 서로 데이터를 주고 받을 수 있는 상태가 된다. 
- 따라서, TCP는 **세션 '상태'**에 따라 서버의 응답이 달라지게 되는 Stateful 하다고 말할수 있는 것

### 문제점 

- 사용중인 서버가 멈추거나 못쓰게되면 다른 서버를 이용해야 하는데, 이때 이전 서버에서 가지고 있던 상태값들은 못쓰게 된다. 
  - 따라서 로그인 유저의 로그인 상태가 풀려버린다. 

---

## Stateless ( 무상태 )

### 정의

- 클라이언트와 서버 관계에서 서버가 클라이언트의 상태를 보존하지 않음을 의미 
  - **서버는 단순히 요청이 오면 응답을 보내는 역할만 수행**하며, 상태 관리는 전적으로 클라이언트에게 책임이 있는 것

### 동작 방식 

- **통신에 필요한 모든 상태 정보들은 클라이언트에서 가지고 있다가 서버와 통신할때 데이터를 실어 보내는 것**이 **무상태(Stateless) 구조**
  - 서버의 부하를 줄일 수 있다. ( 필요한 데이터는 클라이언트가 다 가지고 있기 때문에 )
- 무상태(Stateless) 구조에선 브라우저는 데이터를 전송할 때마다 연결하고 바로 끊어버린다. 
  - 따라서 잘 전달되었는지에 관계없이 그냥 보내버리고 연결 끊어버림 

### Stateless 한 프로토콜 

- 대표적으로 Stateless한 구조를 가진 프로토콜은 **UDP와 HTTP** 가 있다. 
  1. 클라이언트가 자신의 부가정보를 담아 서버로 전송한다. 
     - 이때 서버에 재대로 전송되는지 확인하지 않는다. 
  2. 서버는 요청을 수행하고 결과를 전달한다. 

### 단점

- 클라이언트 요청에 더 많은 데이터가 필요하다. 
  - 요청시 매번 자신의 부가정보를 모두 다 보내줘야하기 때문에 
- 따라서 로그인 상태를 유지해야하는 서비스는 Stateless에 적합하지 않다. 
  - 이 문제를 해결하기 위해 나온 개념이 **Token(토큰)** 이다. 

### JWT 토큰 

- **인증에 필요한 정보들을 암호화시킨 JSON 토큰**
  - 토큰이란, 유일한 값으로 대부분 중요한 데이터에 해쉬함수를 적용한 값이다. 