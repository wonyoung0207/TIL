# Netty 개념정리

---

>[참고 사이트1](https://velog.io/@monami/Netty)
>
>[참고 사이트2](https://hbase.tistory.com/116)

## Netty 

### 정리

1. Netty 는 NIO 로 비동기적 네트워크 통신을 가능하게 하여 무한대기 현상을 해결하도록 도와주는 네트워크 프레임워크이다. 
2. 기존 소켓 통신과 달리 Netty를 사용하면 하나의 Netty port 로 여러 socket을 연결해 처리할 수 있다. 
   1. 서버는 스레드 1개 (Netty와의 연결) 로 여러 client의 연결을 처리할 수 있는 것이다. 


### 정의

- **Java**를 위한 고성능 **네트워크** 애플리케이션 **프레임워크**이다. 
  - **네트워크 통신**을 처리하기 위한 **추상화된 API를 제공**하여 손쉽게 **네트워크 애플리케이션을 구축**하고 관리할 수 있게 도와주는 프레임워크이다.  
- 따라서 Netty는 자바환경에서 네트워크 프로그래밍을 손쉽게 할 수 있게 해주며 고성능, 고안정성의 프로그램을 만들 수 있게 해준다.
  - 현재 Netty는 웹 서버, 프록시 서버, 게임 서버 등 다양한 유형의 네트워크 애플리케이션에 널리 사용되고 있다. 
- Netty는 프로토콜 서버 및 클라이언트와 같은 **네트워크 응용 프로그램**을 빠르고 쉽게 개발할 수 있는 **NIO 클라이언트 서버 프레임 워크**이다. 
  - TCP 및 UDP 소켓 서버와 같은 네트워크 프로그래밍을 크게 단순화하고 간소화할 수 있다. 


### 핵심

- 스레드를 개별적으로 할당하면서 발생하는 **문맥 교환**이나 입력, 출력 데이터 관련된 **무한 대기 현상**이 기존 소켓 프로그래밍의 문제였다. 
- Netty는 이 문제를 해결하기 위해 **NIO 방식(Non-Blocking Input Output)**을 사용한다. 
  - 네트워크 리소스 사용률을 세부적으로 제어하는 **Non-Blocking 호출**이 포함되어 **비동기적인 네트워크 통신**으로 무한대기현상을 회피하는것이 Netty의 특징이자 장점이다. 

### 특징

1. 이벤트 모델을 사용하여 **비동기적**으로 이벤트를 처리
   - 이벤트는 입출력(I/O) 작업, 연결 상태 변경, 예외 처리 등을 포함한다. 
   - 단일 쓰레드에서 많은 연결을 효율적으로 처리할 수 있다. 
2. 다양한 프로토콜(예: HTTP, FTP, TCP)을 지원
   - 프로토콜별로 코덱을 제공
3. 유연하고 모듈화된 구조
   - 각 기능을 모듈화하여 필요한 부분만 사용할 수 있도록 설계
4. 높은 성능과 확장성
   - 내부적으로 사용하는 I/O 모델과 다양한 스레드 모델을 조합하여 효율적인 처리를 가능
   - 다양한 옵션 설정을 통해 성능 튜닝이 가능

### 사용되는 용어

1. **Channel (채널)**
   - 하나 이상의 **입출력 작업을 수행**할 수 있는 **하드웨어 장치**
   - 데이터의 입출력 및 이벤트 처리를 담당
   - 네트워크 소켓과 관련된 작업을 수행
   - 입출력 작업을 비동기적으로 처리하는데 사용
2. **Event (이벤트)**
   - 네트워크에서 발생하는 다양한 상황을 나타내는 객체
     - 예를 들어, 데이터의 도착, 연결 상태 변경, 예외 처리 등이 이벤트이다. 
   - 이벤트는 **채널**에서 **발생**하고 **핸들러**로 전달되어 **처리**된다. 
3. **Handler (핸들러)**
   - 이벤트를 처리하고, 해당 **이벤트**에 대한 **작업을 수행**
   - **채널 파이프라인**에 여러 개의 핸들러가 **등록**되어 이벤트 처리를 담당
4. **Pipeline (파이프라인)**
   - 여러 개의 핸들러로 이루어진 체인
   - 이벤트 처리를 위한 과정을 정의
   - **핸들러들**이 순차적으로 **이벤트를 처리**하는 구조
   - 데이터의 **인바운드(Inbound) 및 아웃바운드(Outbound) 흐름을 관리**
5. **Codec (코덱)**
   - 데이터의 **인코딩 및 디코딩**을 담당하는 **컴포넌트**
   - **데이터**를 네트워크로 **전송하기 전**에 **인코딩**하고, **수신한 데이터**를 **디코딩**하여 응용 프로그램에서 사용할 수 있는 형식으로 **변환**

### 데이터 이동 ( Inbound, Outbound )

1. 네티는 이벤트를 Inbound 이벤트 와 Outbound 이벤트로 구분한다. 
2. Inbound  
   - 데이터를 수신(받는것)할 경우 사용된다. 
3. Outbound 
   - 데이터를 송신(보내는것)하는 경우 사용된다. 

```null
 Client ---------------------------------------------------------Server

 Outbound        ----->  Send    (몇시에요?) ---------->         Inbound

 Inbound         <–--- (오후 8시) Response <-----------         Outbound
```

### 이벤트 기반 네트워크 프로그래밍

- 네트워크 프로그램에서 
  - **이벤트 발생 주체**
    - 소켓
  - **이벤트 종류**
    - 소켓연결
    - 데이터 송수신 
- 따라서 **소켓**에 데이터를 직접 기록하고 **읽으려면** 소켓에 연결된 **소켓채널(NIO)** 또는 스트림을 **사용**해야 한다.
- 데이터 핸들러
  - 데이터 핸들러를 통해 소켓에 접근한다. 
  - 소켓으로 접근하기 위해 채널에 직접 쓰기/읽기 하지 않기위해 사용되는 것
