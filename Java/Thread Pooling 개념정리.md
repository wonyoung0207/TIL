# Thread Pooling 

---

>[참고 사이트1](https://heowc.dev/2018/02/08/thread-pool/)
>
>[참고 사이트2](https://limkydev.tistory.com/55)

## Thread Pooling 이란? 

### 정의 

- 작업 처리에 사용되는 스레드를 제한된 개수만큼 정해 놓고 **작업 큐(**Queue)에 들어오는 작업들을 하나씩 스레드가 맡아 처리하는 것
  - Java에 경우, 기본적으로 `Executors`, `ExecutorService`를 이용하여 Thread Pool를 만들 수 있다.
- 따라서 **스레드 제어 문제를 해결**할 방법으로 **스레드 풀**을 사용한다. 

### 동작방법

<img src="./images/thread pooling 동작원리.png" width=500>

- 스레드를 그때그때 생성하는게 아니라 **사용자가 지정한만큼 스레드를 생성**해두고 작업 큐(대기열)로 부터 **작업을 받아** 스레드가 실행된다. 
  - 만약 설정한 스레드가 모두 바쁘다면 **작업큐에서 대기**한다. 
- 예를들어, 총 16개의 스레드가 있다고 가정하자.
  - 16개 스레드에 도달할 때까지 스레드를 추가하면 성능이 계속 좋아진다.
  - 하지만 16개가 되면 성능은 정체되고, 스레드가 더 추가되어도 동일한 수준으로 유지된다. 

### 스레드를 쉬지않고 계속해서 동작하면 얻을 수 있는 이점

1. **최대 처리량**
2. **리소스의 최대 사용률**

### 단점

1. 메모리 낭비 발생 
   - 스레드 풀에 너무 많은 스레드를 지정해 놓았을 경우 문제가 된다. 
   - 지정된 스레드만큼 메모리를 차지하게 되는데, 너무 많은 스레드를 설정하면 메모리 공간을 무의미하게 잡고 있는게 된다. 
2. 노는 스레드가 발생될 수 있음
   - 1번문제는 공간을 차지하고 있어 메모리 낭비가 되는 문제였지만, 이번 문제는 스레드의 일에 대한 문제이다. 
   - 예를들어, A스레드는 아직 일이 많아서 허덕이고 있는데, B,C는 일을 다하고 A가 열심히 일하는 것을 보고 놀고만 있게 된다. 
     - 스레드는 계속 쉬지 않고 동작하게 하는것이 좋다. 
3. 단점 해결
   - java는 위의 1,2번 문제를 해결하기 위해  **forkJoinPool** 을 지원한다. 
